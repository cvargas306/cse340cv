<% if (title) { %>
  <h1><%= title %></h1>
<% } else {
  res.redirect('/')
} %>

<%- messages() %>

<% if (errors) { %>
  <ul class="notice">
    <% errors.array().forEach(error => { %>
      <li><%= error.msg %></li>
    <% }) %>
  </ul>
<% } %>

<form class="input-box" action="/service/request" method="post">
  <h2>Submit a Service Request</h2>
  <p>Have a question about a vehicle or need assistance? Fill out the form below and our team will get back to you.</p>
  
  <label for="request_type">Request Type*
    <select name="request_type" id="request_type" required>
      <option value="">Choose a type</option>
      <option value="inquiry" <%= locals.request_type === 'inquiry' ? 'selected' : '' %>>General Inquiry</option>
      <option value="service" <%= locals.request_type === 'service' ? 'selected' : '' %>>Service Question</option>
      <option value="financing" <%= locals.request_type === 'financing' ? 'selected' : '' %>>Financing Information</option>
      <option value="other" <%= locals.request_type === 'other' ? 'selected' : '' %>>Other</option>
    </select>
  </label>

  <label for="request_subject">Subject*
    <input type="text" name="request_subject" id="request_subject" required 
           minlength="5" maxlength="100"
           value="<%= locals.request_subject %>" 
           placeholder="Brief description of your request">
  </label>

  <label for="request_message">Message*
    <textarea name="request_message" id="request_message" required 
              minlength="20" maxlength="1000" rows="6"
              placeholder="Please provide details about your request..."><%= locals.request_message %></textarea>
  </label>

  <% if (locals.inv_id) { %>
    <input type="hidden" name="inv_id" value="<%= locals.inv_id %>">
    <p class="notice">This request is about a specific vehicle.</p>
  <% } %>

  <input type="submit" value="SUBMIT REQUEST">
  <p><a href="/service/my-requests">View My Requests</a></p>
</form>