<!-- register.ejs -->
<h1><%- title %></h1>
<%- messages() %>

<div class="account-container" role="region" aria-labelledby="accountFormTitle">
  <h2 id="accountFormTitle" class="sr-only">Registration form</h2>

  <form class="account-form" action="/account/register" method="post" novalidate>
    <div class="form-field">
      <label for="reg_firstname">First name</label>
      <input id="reg_firstname" class="form-control" type="text"
             name="account_firstname" required autocomplete="given-name"
             value="<%= locals.account_firstname || '' %>">
    </div>

    <div class="form-field">
      <label for="reg_lastname">Last name</label>
      <input id="reg_lastname" class="form-control" type="text"
             name="account_lastname" required autocomplete="family-name"
             value="<%= locals.account_lastname || '' %>">
    </div>

    <div class="form-field">
      <label for="reg_email">Email address</label>
      <input id="reg_email" class="form-control" type="email"
             name="account_email" required autocomplete="email"
             value="<%= locals.account_email || '' %>">
    </div>

    <div class="form-field">
      <label for="reg_password">Password</label>
      <div class="password-field">
        <input id="reg_password" class="form-control" type="password"
               name="account_password" required autocomplete="new-password"
               pattern="^(?=.*[A-Z])(?=.*\\d)(?=.*[^\\w\\s]).{12,}$"
               title="12+ chars, 1 uppercase, 1 number, 1 special character">
        <button type="button" class="reveal-button" aria-controls="reg_password" aria-pressed="false">Show</button>
      </div>
      <p class="fine-print">Password must be 12+ characters and include 1 capital letter, 1 number, and 1 special character.</p>
    </div>

    <button class="btn btn-primary" type="submit">Register</button>
  </form>
</div>

<script>
  document.querySelectorAll('.reveal-button').forEach((btn) => {
    const input = document.getElementById(btn.getAttribute('aria-controls'));
    if (!input) return;
    btn.addEventListener('click', () => {
      const isPwd = input.type === 'password';
      input.type = isPwd ? 'text' : 'password';
      btn.setAttribute('aria-pressed', String(isPwd));
      btn.textContent = isPwd ? 'Hide' : 'Show';
    });
  });
</script>
